{
    "version": "3.3.0",
    "storage": {
        "method": "json",
        "settings": {
            "immutable": false,
            "path": "/etc/security/rootasrole.json"
        }
    },
    "options": {
        "timeout": {
            "type": "ppid",
            "duration": "00:05:00"
        },
        "path": {
            "default": "delete",
            "add": [
                "/usr/local/sbin",
                "/usr/local/bin",
                "/usr/sbin",
                "/usr/bin",
                "/sbin",
                "/bin",
                "/snap/bin"
            ]
        },
        "env": {
            "default": "delete",
            "keep": [
                "HOME",
                "USER",
                "LOGNAME",
                "COLORS",
                "DISPLAY",
                "HOSTNAME",
                "KRB5CCNAME",
                "LS_COLORS",
                "PS1",
                "PS2",
                "XAUTHORY",
                "XAUTHORIZATION",
                "XDG_CURRENT_DESKTOP"
            ],
            "check": [
                "COLORTERM",
                "LANG",
                "LANGUAGE",
                "LC_*",
                "LINGUAS",
                "TERM",
                "TZ"
            ]
        },
        "root": "user",
        "bounding": "strict",
        "wildcard-denied": ";&|"
    },
    "roles": [
        { 
            "name": "rar_ansible",
            "purpose": "Ansible internal tasks",
            "actors": [
                {
                    "type": "group",
                    "groups": [
                        "ansible"
                    ]
                }
            ],
            "tasks": [
                {
                    "name": "ansible_chown",
                    "purpose": "Reserved task for Ansible",
                    "cred": {
                        "setuid": "root",
                        "setgid": ["root","ansible"],
                        "capabilities": {
                            "default": "none",
                            "add": [
                                "CAP_DAC_OVERRIDE",
                                "CAP_CHOWN"
                            ]
                        }
                    },
                    "commands": {
                        "default": "none",
                        "add": [
                            "/usr/bin/chown '^-R \"?\\d+\"?:\"?\\d+\"? \"?/tmp/ansible-tmp-.*\"?/$'"
                        ]
                    }
                },
                {
                    "name": "ansible_id",
                    "purpose": "Reserved task for Ansible",
                    "cred": {
                        "setuid": "root",
                        "setgid": ["root","ansible"]
                    },
                    "commands": {
                        "default": "none",
                        "add": [
                            "/usr/bin/id -u"
                        ]
                    }
                },
                {
                    "name": "generate_rar",
                    "purpose": "Ansible become capable",
                    "cred": {
                        "setuid": "root",
                        "setgid": "root",
                        "capabilities": {
                            "default": "all"
                        }
                    },
                    "commands": {
                        "default": "none",
                        "add": [
                            "/usr/bin/gensr '^generate .*$'"
                        ]
                    }
                },
                {
                    "name": "deploy_rar",
                    "purpose": "Ansible become capable",
                    "cred": {
                        "capabilities": {
                            "default": "all"
                        }
                    },
                    "commands": {
                        "default": "none",
                        "add": [
                            "/usr/bin/gensr '^deploy -c \"/[^\"]*\"$'"
                        ]
                    }
                }
            ],
            "options": {
                "env": {
                    "default": "keep"
                },
                "authentication": "skip"
            }
        }
    ]
}